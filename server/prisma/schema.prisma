// This is your Prisma schema file,
// learn more about it in the docs: https://pris.ly/d/prisma-schema

generator client {
  provider      = "prisma-client-js"
  binaryTargets = ["native", "linux-musl-openssl-3.0.x"]
}

datasource db {
  provider = "postgresql"
  url      = env("DATABASE_URL")
}

model User {
  id           String       @id @unique
  email        String       @unique
  HashPassword String?
  Avatar       String?
  nickName     String       @unique
  fullName     String
  status       Boolean      @default(true)
  F2A          Boolean      @default(false)
  active       Boolean      @default(false)
  friends      Friendship[]
  rooms        Room[]
  messages     Message[]
}

model Friendship {
  id      String @id
  userId1 String
  userId2 String
  status  String
  user    User[]

  @@unique([userId1, userId2])
}

model Room {
  id             Int         @id @default(autoincrement())
  createdAt      DateTime    @default(now())
  updatedAt      DateTime    @updatedAt
  roomTitle      String      @unique
  users          User[]
  messages       Message[]
  isConversation Boolean
  privacy        RoomPrivacy @default(PUBLIC)
  password       String?
  owner          String[]
  admins         String[]
  banned         String[]
}

model Message {
  id        Int      @id @default(autoincrement())
  message   String
  createdAt DateTime @default(now())
  user      User     @relation(fields: [userId], references: [id])
  userId    String
  room      Room     @relation(fields: [roomId], references: [id])
  roomId    Int
}

enum RoomPrivacy {
  PUBLIC
  PRIVATE
  PROTECTED
}
